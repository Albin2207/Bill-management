import 'package:cloud_firestore/cloud_firestore.dart';
import '../../domain/entities/document_settings_entity.dart';

class DocumentSettingsModel extends DocumentSettingsEntity {
  const DocumentSettingsModel({
    required super.id,
    required super.userId,
    super.template,
    super.primaryColor,
    super.secondaryColor,
    super.fontStyle,
    super.fontSize,
    super.orientation,
    super.showLogo,
    super.showCompanyDetails,
    super.showBankDetails,
    super.showSignature,
    super.showTerms,
    super.showQRCode,
    super.customHeader,
    super.customFooter,
    super.defaultTerms,
    super.defaultNotes,
    super.companyName,
    super.companyGSTIN,
    super.companyAddress,
    super.companyPhone,
    super.companyEmail,
    super.companyWebsite,
    super.companyLogo,
    super.bankName,
    super.accountNumber,
    super.ifscCode,
    super.branchName,
    super.upiId,
    super.signatureUrl,
    super.authorizedSignatory,
    super.autoNumbering,
    super.includeHSNColumn,
    super.includeTaxColumn,
    super.showItemImages,
    super.roundOffTotal,
    required super.createdAt,
    required super.updatedAt,
  });

  factory DocumentSettingsModel.fromJson(Map<String, dynamic> json) {
    return DocumentSettingsModel(
      id: json['id'] as String,
      userId: json['userId'] as String,
      template: DocumentTemplate.values.firstWhere(
        (e) => e.name == json['template'],
        orElse: () => DocumentTemplate.classic,
      ),
      primaryColor: json['primaryColor'] as String? ?? '#2196F3',
      secondaryColor: json['secondaryColor'] as String? ?? '#FFC107',
      fontStyle: FontStyle.values.firstWhere(
        (e) => e.name == json['fontStyle'],
        orElse: () => FontStyle.roboto,
      ),
      fontSize: (json['fontSize'] as num?)?.toDouble() ?? 12.0,
      orientation: DocumentOrientation.values.firstWhere(
        (e) => e.name == json['orientation'],
        orElse: () => DocumentOrientation.portrait,
      ),
      showLogo: json['showLogo'] as bool? ?? true,
      showCompanyDetails: json['showCompanyDetails'] as bool? ?? true,
      showBankDetails: json['showBankDetails'] as bool? ?? true,
      showSignature: json['showSignature'] as bool? ?? true,
      showTerms: json['showTerms'] as bool? ?? true,
      showQRCode: json['showQRCode'] as bool? ?? false,
      customHeader: json['customHeader'] as String?,
      customFooter: json['customFooter'] as String?,
      defaultTerms: json['defaultTerms'] as String?,
      defaultNotes: json['defaultNotes'] as String?,
      companyName: json['companyName'] as String?,
      companyGSTIN: json['companyGSTIN'] as String?,
      companyAddress: json['companyAddress'] as String?,
      companyPhone: json['companyPhone'] as String?,
      companyEmail: json['companyEmail'] as String?,
      companyWebsite: json['companyWebsite'] as String?,
      companyLogo: json['companyLogo'] as String?,
      bankName: json['bankName'] as String?,
      accountNumber: json['accountNumber'] as String?,
      ifscCode: json['ifscCode'] as String?,
      branchName: json['branchName'] as String?,
      upiId: json['upiId'] as String?,
      signatureUrl: json['signatureUrl'] as String?,
      authorizedSignatory: json['authorizedSignatory'] as String?,
      autoNumbering: json['autoNumbering'] as bool? ?? true,
      includeHSNColumn: json['includeHSNColumn'] as bool? ?? true,
      includeTaxColumn: json['includeTaxColumn'] as bool? ?? true,
      showItemImages: json['showItemImages'] as bool? ?? false,
      roundOffTotal: json['roundOffTotal'] as bool? ?? false,
      createdAt: (json['createdAt'] as Timestamp).toDate(),
      updatedAt: (json['updatedAt'] as Timestamp).toDate(),
    );
  }

  factory DocumentSettingsModel.fromEntity(DocumentSettingsEntity entity) {
    return DocumentSettingsModel(
      id: entity.id,
      userId: entity.userId,
      template: entity.template,
      primaryColor: entity.primaryColor,
      secondaryColor: entity.secondaryColor,
      fontStyle: entity.fontStyle,
      fontSize: entity.fontSize,
      orientation: entity.orientation,
      showLogo: entity.showLogo,
      showCompanyDetails: entity.showCompanyDetails,
      showBankDetails: entity.showBankDetails,
      showSignature: entity.showSignature,
      showTerms: entity.showTerms,
      showQRCode: entity.showQRCode,
      customHeader: entity.customHeader,
      customFooter: entity.customFooter,
      defaultTerms: entity.defaultTerms,
      defaultNotes: entity.defaultNotes,
      companyName: entity.companyName,
      companyGSTIN: entity.companyGSTIN,
      companyAddress: entity.companyAddress,
      companyPhone: entity.companyPhone,
      companyEmail: entity.companyEmail,
      companyWebsite: entity.companyWebsite,
      companyLogo: entity.companyLogo,
      bankName: entity.bankName,
      accountNumber: entity.accountNumber,
      ifscCode: entity.ifscCode,
      branchName: entity.branchName,
      upiId: entity.upiId,
      signatureUrl: entity.signatureUrl,
      authorizedSignatory: entity.authorizedSignatory,
      autoNumbering: entity.autoNumbering,
      includeHSNColumn: entity.includeHSNColumn,
      includeTaxColumn: entity.includeTaxColumn,
      showItemImages: entity.showItemImages,
      roundOffTotal: entity.roundOffTotal,
      createdAt: entity.createdAt,
      updatedAt: entity.updatedAt,
    );
  }

  Map<String, dynamic> toJson() {
    return {
      'id': id,
      'userId': userId,
      'template': template.name,
      'primaryColor': primaryColor,
      'secondaryColor': secondaryColor,
      'fontStyle': fontStyle.name,
      'fontSize': fontSize,
      'orientation': orientation.name,
      'showLogo': showLogo,
      'showCompanyDetails': showCompanyDetails,
      'showBankDetails': showBankDetails,
      'showSignature': showSignature,
      'showTerms': showTerms,
      'showQRCode': showQRCode,
      'customHeader': customHeader,
      'customFooter': customFooter,
      'defaultTerms': defaultTerms,
      'defaultNotes': defaultNotes,
      'companyName': companyName,
      'companyGSTIN': companyGSTIN,
      'companyAddress': companyAddress,
      'companyPhone': companyPhone,
      'companyEmail': companyEmail,
      'companyWebsite': companyWebsite,
      'companyLogo': companyLogo,
      'bankName': bankName,
      'accountNumber': accountNumber,
      'ifscCode': ifscCode,
      'branchName': branchName,
      'upiId': upiId,
      'signatureUrl': signatureUrl,
      'authorizedSignatory': authorizedSignatory,
      'autoNumbering': autoNumbering,
      'includeHSNColumn': includeHSNColumn,
      'includeTaxColumn': includeTaxColumn,
      'showItemImages': showItemImages,
      'roundOffTotal': roundOffTotal,
      'createdAt': Timestamp.fromDate(createdAt),
      'updatedAt': Timestamp.fromDate(updatedAt),
    };
  }
}

